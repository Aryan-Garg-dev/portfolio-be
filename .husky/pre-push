#!/bin/bash

# Exit on any error
set -e

echo "ğŸ” Checking for model file changes..."

# Check if any .model.ts file was changed in the last commit
if git diff --name-only HEAD~1 HEAD | grep -qE '\.model\.ts$'; then
  echo "ğŸ”„ Model file changed. Running db:sync..."
  if bun run db:sync; then
    echo "âœ… db:sync completed successfully"
  else
    echo "âŒ db:sync failed"
    exit 1
  fi
else
  echo "âœ… No model file changes. Skipping db:sync."
fi

echo "ğŸš€ Pre-push checks completed"